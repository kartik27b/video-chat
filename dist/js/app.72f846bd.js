(function(e){function t(t){for(var o,i,a=t[0],s=t[1],l=t[2],d=0,f=[];d<a.length;d++)i=a[d],Object.prototype.hasOwnProperty.call(c,i)&&c[i]&&f.push(c[i][0]),c[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);u&&u(t);while(f.length)f.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,a=1;a<n.length;a++){var s=n[a];0!==c[s]&&(o=!1)}o&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},c={app:0},r=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/video-chat/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=s;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"1d5a":function(e,t,n){"use strict";n("b50d")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),c={class:"h-screen w-full flex bg-gray-800 text-white"},r={class:"w-96 p-4 flex"},i={class:"flex-1 bg-gray-700 rounded-lg  p-4 shadow-2xl flex flex-col"},a={class:"flex items-center mb-3"},s={class:""},l=Object(o["g"])(" My Id: "),u={class:"font-bold"},d={class:"flex"},f=Object(o["g"])("Connect"),p={key:0,class:"my-2"},b={key:1,class:"mx-2"},m={class:"flex-1 overflow-y-scroll my-2"},h=Object(o["g"])("Send"),v={class:"flex-1 flex p-4"},O={class:"flex-1 bg-gray-700 rounded-md shadow-2xl flex p-4 flex-wrap overflow-y-scroll justify-center items-center"},j={key:0,ref:"myVideo",class:"w-96 h-96 object-cover bg-gray-700 m-2  border-gray-900 rounded-lg border-4 shadow-2xl",autoplay:""};function y(e,t,n,y,g,S){var w=Object(o["l"])("v-button"),x=Object(o["l"])("v-input"),T=Object(o["l"])("v-rotate-loader");return Object(o["i"])(),Object(o["e"])("div",c,[Object(o["h"])("div",r,[Object(o["h"])("div",i,[Object(o["h"])("div",null,[Object(o["h"])("div",a,[Object(o["h"])("h1",s,[l,Object(o["h"])("span",u,Object(o["m"])(g.myId),1)]),Object(o["h"])(w,{onClick:S.toggleVideoShow},{default:Object(o["p"])((function(){return[Object(o["g"])(Object(o["m"])(g.isVideoShowing?"Hide":"Show")+" Video",1)]})),_:1},8,["onClick"])]),Object(o["h"])("div",d,[Object(o["h"])(x,{modelValue:g.connectTo,"onUpdate:modelValue":t[1]||(t[1]=function(e){return g.connectTo=e}),placeholder:"Receiver Id"},null,8,["modelValue"]),Object(o["h"])(w,{onClick:S.connectMe},{default:Object(o["p"])((function(){return[f]})),_:1},8,["onClick"])]),g.loading?(Object(o["i"])(),Object(o["e"])("div",p,[Object(o["h"])(T)])):Object(o["f"])("",!0),g.error?(Object(o["i"])(),Object(o["e"])("h1",b,Object(o["m"])(g.error),1)):Object(o["f"])("",!0),(Object(o["i"])(!0),Object(o["e"])(o["a"],null,Object(o["j"])(g.connectedClients,(function(e){return Object(o["i"])(),Object(o["e"])("h1",{key:e},Object(o["m"])(e)+" Connected ",1)})),128))]),Object(o["h"])("div",m,[(Object(o["i"])(!0),Object(o["e"])(o["a"],null,Object(o["j"])(g.messages,(function(e){return Object(o["i"])(),Object(o["e"])("h1",{key:e.id},Object(o["m"])(e.message),1)})),128))]),Object(o["h"])("form",{onSubmit:t[3]||(t[3]=Object(o["r"])((function(){return S.sendMessage&&S.sendMessage.apply(S,arguments)}),["prevent"])),class:"flex"},[Object(o["h"])(x,{placeholder:"Message",modelValue:g.message,"onUpdate:modelValue":t[2]||(t[2]=function(e){return g.message=e})},null,8,["modelValue"]),Object(o["h"])(w,{type:"submit"},{default:Object(o["p"])((function(){return[h]})),_:1})],32)])]),Object(o["h"])("div",v,[Object(o["h"])("div",O,[Object(o["h"])(o["b"],{name:"video"},{default:Object(o["p"])((function(){return[g.isVideoShowing?(Object(o["i"])(),Object(o["e"])("video",j,null,512)):Object(o["f"])("",!0)]})),_:1}),Object(o["h"])(o["c"],{name:"video"},{default:Object(o["p"])((function(){return[(Object(o["i"])(!0),Object(o["e"])(o["a"],null,Object(o["j"])(g.videoStreams,(function(e,t){return Object(o["i"])(),Object(o["e"])("video",{key:t,ref:S.createRef(t),class:"w-96 h-96 object-cover bg-gray-700 m-2  border-gray-900 rounded-lg border-4 shadow-2xl",autoplay:""},null,512)})),128))]})),_:1})])])])}var g=n("ade3"),S=n("b85c"),w=n("a0bc"),x=n.n(w),T={class:"font-medium px-2 py-1 ml-2 min bg-gray-500 focus:outline-none"};function C(e,t,n,c,r,i){return Object(o["i"])(),Object(o["e"])("button",T,[Object(o["k"])(e.$slots,"default")])}var V={components:{},name:"v-button"};V.render=C;var D=V;function k(e,t,n,c,r,i){return Object(o["q"])((Object(o["i"])(),Object(o["e"])("input",{type:"text",class:"flex-1 px-2 py-1 focus:outline-none rounded-md text-black","onUpdate:modelValue":t[1]||(t[1]=function(e){return i.value=e})},null,512)),[[o["n"],i.value]])}var E={name:"v-input",props:["modelValue"],emits:["update:modelValue"],computed:{value:{get:function(){return this.modelValue},set:function(e){this.$emit("update:modelValue",e)}}}};E.render=k;var M=E,_={class:"v-spinner"};function N(e,t,n,c,r,i){return Object(o["q"])((Object(o["i"])(),Object(o["e"])("div",_,[Object(o["h"])("div",{class:"v-pulse v-pulse1",style:[r.spinnerStyle,r.spinnerDelay1]},null,4),Object(o["h"])("div",{class:"v-pulse v-pulse2",style:[r.spinnerStyle,r.spinnerDelay2]},null,4),Object(o["h"])("div",{class:"v-pulse v-pulse3",style:[r.spinnerStyle,r.spinnerDelay3]},null,4)],512)),[[o["o"],n.loading]])}var I={name:"v-rotate-loader",props:{loading:{type:Boolean,default:!0},color:{type:String,default:"#5dc596"},size:{type:String,default:"15px"},margin:{type:String,default:"2px"},radius:{type:String,default:"100%"}},data:function(){return{spinnerStyle:{backgroundColor:this.color,width:this.size,height:this.size,margin:this.margin,borderRadius:this.radius,display:"inline-block",animationName:"v-pulseStretchDelay",animationDuration:"0.75s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.2,.68,.18,1.08)",animationFillMode:"both"},spinnerDelay1:{animationDelay:"0.12s"},spinnerDelay2:{animationDelay:"0.24s"},spinnerDelay3:{animationDelay:"0.36s"}}}};n("1d5a");I.render=N;var $,P=I,z={CONNECTED_CLIENTS:"CONNECTED_CLIENTS",MESSAGE:"MESSAGE"},L={components:{VButton:D,VInput:M,VRotateLoader:P},name:"App",data:function(){return{loading:!1,error:"",isVideoShowing:!0,myId:"",message:"",connectTo:"",conn:null,peer:null,myStream:null,messages:[],remoteStreams:{},connectedClients:[],videoStreams:{}}},computed:{},watch:{connectedClients:function(e){console.log(e)}},methods:($={toggleVideoShow:function(){var e=this;this.isVideoShowing=!this.isVideoShowing,this.isVideoShowing&&this.$nextTick((function(){e.$refs.myVideo.srcObject=e.myStream}))},createRef:function(e){return"video-"+e},createMessage:function(e){return{id:(new Date).toISOString(),message:e}},sendMessage:function(){var e=this.createMessage(this.message);for(var t in this.remoteStreams)this.remoteStreams[t].connection.send({type:z.MESSAGE,data:e});this.messages.push(e)}},Object(g["a"])($,z.CONNECTED_CLIENTS,(function(e){var t,n=this,o=Object(S["a"])(e);try{var c=function(){var e=t.value,o=n.peer.connect(e),c=n.peer.call(e,n.myStream),r=o.peer;n.remoteStreams[r]={connection:o,call:c};var i=n.remoteStreams[r];i.connection.on("open",(function(){n.connectedClients.push(r),i.connection.on("data",(function(e){return n.mapDataToType(e)}))})),i.call.on("stream",(function(e){n.videoStreams[r]=e,n.$nextTick((function(){n.$refs["video-"+r].srcObject=n.videoStreams[r]}))}))};for(o.s();!(t=o.n()).done;)c()}catch(r){o.e(r)}finally{o.f()}})),Object(g["a"])($,z.MESSAGE,(function(e){console.log(e),this.messages.push(e)})),Object(g["a"])($,"mapDataToType",(function(e){var t=!0;for(var n in z)e.type===n&&(t=!0);t&&this[e.type](e.data)})),Object(g["a"])($,"initialize",(function(){var e=this;this.peer=new x.a,this.peer.on("open",(function(t){e.myId=t,console.log("My peer ID is: "+t)})),this.peer.on("connection",(function(t){var n=t.peer;e.remoteStreams[n]={connection:t,call:null};var o=function(t){console.log(t,e.remoteStreams[t]);var n=e.remoteStreams[t];n.connection.on("open",(function(){console.log(n,"conneceted"),e.connectedClients.push(t),n.connection.on("data",(function(t){return e.mapDataToType(t)}))}))};for(var c in e.remoteStreams)o(c)})),this.peer.on("call",(function(t){var n=t.peer;t.answer(e.myStream),e.remoteStreams[n].call=t,t.on("stream",(function(t){e.videoStreams[n]=t,e.$nextTick((function(){e.$refs["video-"+n].srcObject=e.videoStreams[n]}))}))})),this.peer.on("error",(function(){e.error="Could not connect with given id",e.loading=!1})),this.peer.on("disconnect",(function(){console.log(e.peer.id," disconnected")}))})),Object(g["a"])($,"connectMe",(function(){var e=this,t=this.peer.connect(this.connectTo),n=this.peer.call(this.connectTo,this.myStream);this.loading=!0;var o=t.peer;this.remoteStreams[o]={connection:t,call:n},this.connectTo="";var c=function(t){console.log(t,e.remoteStreams[t]);var n=e.remoteStreams[t];n.connection.on("open",(function(){e.loading=!1,console.log(n,"conneceted"),n.connection.send({type:z.CONNECTED_CLIENTS,data:e.connectedClients}),e.connectedClients.push(t),n.connection.on("data",(function(t){return e.mapDataToType(t)}))})),n.call.on("stream",(function(n){e.loading=!1,e.videoStreams[t]=n,e.$nextTick((function(){e.$refs["video-"+t].srcObject=e.videoStreams[t]}))}))};for(var r in this.remoteStreams)c(r)})),$),created:function(){var e=this;this.initialize(),navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){e.myStream=t,e.$refs.myVideo.srcObject=t})).catch((function(e){console.error("Failed to get local stream",e)}))}};n("61c4");L.render=y;var U=L;n("ba8c");Object(o["d"])(U).mount("#app")},"5e11":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="5e11"},"61c4":function(e,t,n){"use strict";n("db27")},b50d:function(e,t,n){},ba8c:function(e,t,n){},db27:function(e,t,n){}});
//# sourceMappingURL=app.72f846bd.js.map